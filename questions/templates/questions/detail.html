{% extends "main.html" %}

{% block content %}
  <div class="container my-4">

    <!-- Fragetext -->
    <header class="mb-3">
      <h1 class="h4">{{ question.questiontext }}</h1>
    </header>

    <!-- Wellen-Pills -->
    {% if waves %}
      <ul class="nav nav-pills gap-1 flex-nowrap overflow-auto mb-3 small" style="white-space: nowrap;">
        {% for w in waves %}
          <li class="nav-item">
            {% if active_wave and w.id == active_wave.id %}
              <a href="{% url 'question_detail' question.id %}?wave={{ w.id }}"
                class="nav-link rounded-pill py-1 px-2 bg-primary text-white"
                aria-current="page">
                {{ w }}
              </a>
            {% else %}
              <a href="{% url 'question_detail' question.id %}?wave={{ w.id }}"
                class="nav-link rounded-pill py-1 px-2 bg-secondary-subtle text-secondary-emphasis border">
                {{ w }}
              </a>
            {% endif %}
          </li>
        {% endfor %}
      </ul>

    {% endif %}

    <!-- Variablenliste -->
    <section>
      <h2 class="h5 mb-3">
        Variablen{% if active_wave %} in {{ active_wave.name|default:active_wave }}{% endif %}
      </h2>

      {% if variables %}
        <div class="list-group">
          {% for v in variables %}
            <a
              class="list-group-item list-group-item-action"
              href="{% url 'variable_detail' v.id %}" 
            >
              <div class="fw-semibold">{{ v.varname }}</div>
              {% if v.varlab %}
                <div class="text-muted text-truncate">{{ v.varlab }}</div>
              {% endif %}
            </a>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted mb-0">In dieser Welle sind keine Variablen verknüpft.</p>
      {% endif %}
    </section>

    <!-- pagenamme in selected wavew -->
    {% if page %}
      <p class="text-muted small mb-3">
        Seite im Instrument:
        <span class="fw-semibold">{{ page.pagename }}</span>
      </p>
    {% endif %}

    <!-- Screenshot-Gallery -->
    {% if screenshots %}
      <div class="my-3">
        <h2 class="h6 mb-2">Screenshots</h2>
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
          {% for s in screenshots %}
            <div class="col">
              <div class="card shadow-sm">

                {# Klickbare Lightbox #}
                <a href="/{{ s.image_path }}"
                  class="glightbox"
                  data-gallery="question-{{ question.id }}"
                  data-title="Sprache: {{ s.language }} | Gerät: {{ s.device }}{% if page %} | Seite: {{ page.pagename }}{% endif %}">
                  <img src="/{{ s.image_path }}"
                      class="card-img-top"
                      alt="Screenshot {{ forloop.counter }}"
                      style="cursor: zoom-in;">
                </a>

                <div class="card-body small">
                  <div><strong>Sprache:</strong> {{ s.language }}</div>
                  <div><strong>Gerät:</strong> {{ s.device }}</div>
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}


  </div>
{% endblock %}

